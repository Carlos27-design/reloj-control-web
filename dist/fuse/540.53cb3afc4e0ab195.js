"use strict";(self.webpackChunkfuse=self.webpackChunkfuse||[]).push([[540],{4540:(X,b,s)=>{s.r(b),s.d(b,{EntradaSalidaModule:()=>I});var x=s(6895),p=s(2510),E=s(5861);class S{}var t=s(4650),u=s(129),w=s(529);const m=u.F+"registro/";let C=(()=>{class a{constructor(e){this._http=e}get(e){return this._http.get(m+e,u.o)}getAll(){return this._http.get(m,u.o)}create(e){return this._http.post(m,e,u.o)}update(e,n){return this._http.patch(m+e,n,u.o)}delete(e){return this._http.delete(m+e,u.o)}}return a.\u0275fac=function(e){return new(e||a)(t.LFG(w.eN))},a.\u0275prov=t.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a})(),T=(()=>{class a{constructor(e){this._http=e}getPosition(){return new Promise((e,n)=>{navigator.geolocation.getCurrentPosition(r=>{e({lng:r.coords.longitude,lat:r.coords.latitude})},r=>{n(r)})})}}return a.\u0275fac=function(e){return new(e||a)(t.LFG(w.eN))},a.\u0275prov=t.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a})();var M=s(8951);let Z=(()=>{class a{constructor(e,n,r,l){this._registroService=e,this._router=n,this._map=r,this._authService=l,this.dia="",this.mes="",this.anio=0,this.hora="",this.minuto="",this.segundo="",this.desactivarGuardarEntrada=!1,this.desactivarGuardarSalida=!1,this.disabled=!1}ngOnInit(){this.updateTime(),this.getUsuario()}updateTime(){this.date=new Date,this.dia=this.date.getDate()<10?`0${this.date.getDate()}`:`${this.date.getDate()}`,this.mes=this.date.getMonth()+1<10?`0${this.date.getMonth()+1}`:`${this.date.getMonth()+1}`,this.anio=this.date.getFullYear(),this.hora=this.date.getHours()<10?`0${this.date.getHours()}`:`${this.date.getHours()}`,this.minuto=this.date.getMinutes()<10?`0${this.date.getMinutes()}`:`${this.date.getMinutes()}`,this.segundo=this.date.getSeconds()<10?`0${this.date.getSeconds()}`:`${this.date.getSeconds()}`,setTimeout(()=>{this.updateTime()},1e3)}getUsuario(){var e=this;return(0,E.Z)(function*(){const n=yield e._authService.accessToken.split(".")[1],r=atob(n),l=JSON.parse(r);e.trabajador=l.trabajador,console.log(e.trabajador)})()}registrarEntrada(){this.desactivarGuardarEntrada=!0;let e=new S;this._map.getPosition().then(n=>{e.latitudEntrada=n.lat,e.longitudEntrada=n.lng,e.fecha=new Date,e.entrada=new Date,console.log(e),this._registroService.create(e).subscribe(r=>{this.toBack()},r=>{this.desactivarGuardarEntrada=!1})})}registrarSalida(){this.desactivarGuardarSalida=!0;let e=new S;this._map.getPosition().then(n=>{e.latitudSalida=n.lat,e.longitudSalida=n.lng,e.fecha=new Date,e.salida=new Date,this._registroService.create(e).subscribe(r=>{this.toBack()},r=>{this.desactivarGuardarSalida=!1})})}toVerEntrada(){this._router.navigate(["entradaSalida/ver"])}toBack(){this._router.navigate(["entradaSalida"])}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(C),t.Y36(p.F0),t.Y36(T),t.Y36(M.e))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-entrada-salida"]],decls:32,vars:9,consts:[[1,"flex","flex-col","flex-auto","min-w-0"],[1,"flex","flex-col","sm:flex-row","flex-0","sm:items-center","sm:justify-between","p-6","sm:py-8","sm:px-10","border-b","bg-card","dark:bg-transparent"],[1,"flex-1","min-w-0"],[1,"mt-2"],[1,"text-3xl","md:text-4xl","font-extrabold","tracking-tight","leading-7","sm:leading-10","truncate"],[1,"row","principal"],[1,"col-sm-4"],[1,"row"],[1,"col-sm-12"],[1,"nombre"],[1,"hora"],[1,"fecha"],[1,"flex-auto","p-6","sm:p-10"],[1,"button-center"],["type","button",1,"text-white","bg-blue-700","hover:bg-blue-800","focus:outline-none","focus:ring-4","focus:ring-blue-300","font-extrabold","rounded-full","text-sm","px-22","py-2.5","text-center","mr-2","mb-2","dark:bg-blue-600","dark:hover:bg-blue-700","dark:focus:ring-blue-800",3,"disabled","click"],["type","button",1,"text-white","bg-red-700","hover:bg-red-800","focus:outline-none","focus:ring-4","focus:ring-red-300","font-extrabold","rounded-full","text-sm","px-22","py-2.5","text-center","mr-2","mb-2","dark:bg-red-600","dark:hover:bg-red-700","dark:focus:ring-red-800",3,"disabled","click"],["type","button",1,"text-white","bg-blue-700","hover:bg-blue-800","focus:outline-none","focus:ring-4","focus:ring-blue-300","font-extrabold","rounded-full","text-sm","px-22","py-2.5","text-center","mr-2","mb-2","dark:bg-blue-600","dark:hover:bg-blue-700","dark:focus:ring-blue-800",3,"click"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h2",4),t._uU(5," Entrada y Salida "),t.qZA()()()(),t.TgZ(6,"div",5)(7,"div",6)(8,"div",7)(9,"div",8)(10,"p",9),t._uU(11),t.qZA()()(),t._UZ(12,"br"),t.TgZ(13,"div",7)(14,"div",8)(15,"p",10),t._uU(16),t.qZA()()()(),t._UZ(17,"br"),t.TgZ(18,"div",7)(19,"div",8)(20,"p",11),t._uU(21),t.qZA()()()(),t.TgZ(22,"div",12)(23,"div",13)(24,"button",14),t.NdJ("click",function(){return n.registrarEntrada()}),t._uU(25,"Entrada"),t.qZA()(),t.TgZ(26,"div",13)(27,"button",15),t.NdJ("click",function(){return n.registrarSalida()}),t._uU(28,"Salida"),t.qZA()(),t.TgZ(29,"div",13)(30,"button",16),t.NdJ("click",function(){return n.toVerEntrada()}),t._uU(31,"Ver Entrada y Salidas"),t.qZA()()()()),2&e&&(t.xp6(11),t.hij("Bienvenido ",n.trabajador,""),t.xp6(5),t.lnq("",n.hora,":",n.minuto,":",n.segundo,""),t.xp6(5),t.lnq("",n.dia,"-",n.mes,"-",n.anio,""),t.xp6(3),t.Q6J("disabled",n.desactivarGuardarEntrada),t.xp6(3),t.Q6J("disabled",n.desactivarGuardarSalida))},styles:[".button-center[_ngcontent-%COMP%]{margin:50}.hora[_ngcontent-%COMP%]{text-align:center;font-size:50px}.fecha[_ngcontent-%COMP%]{text-align:center;font-size:32px}.nombre[_ngcontent-%COMP%]{text-align:center;font-size:22px}.principal[_ngcontent-%COMP%]{margin-top:15px}.button-center[_ngcontent-%COMP%]{text-align:center;font-size:20px}"]}),a})();var d=s(7155),g=s(6308),k=s(3546),y=s(4859),f=s(9798),A=s(4850),D=s(4466),U=s(4144),$=s(1677),O=s(9549),_=s(7392),P=s(2003),H=s(4327),j=s(4313);let N=(()=>{class a{constructor(){}exportarExcel(e){const n=new j.Workbook,r=n.addWorksheet("RegistrosHoraTrabajador");r.columns=[{header:"fecha",key:"fecha",width:10},{header:"Entradas",key:"Entradas",width:10},{header:"Salidas",key:"Salidas",width:10},{header:"Trabajador",key:"Trabajador",width:10}],e.forEach(l=>{const i=new Date(l.entrada),h=new Date(l.entrada),c=new Date(l.salida);r.addRow({fecha:this.extractDate(i),Entradas:this.extractHoras(h),Salidas:this.extractHoras(c),Trabajador:l.Trabajador.nombre+" "+l.Trabajador.apellido})});for(let l=0;l<r.columns.length;l+=1){let i=0;const h=r.columns[l];for(let c=0;c<h.values.length;c+=1){const v=h.values[c];v>i&&(i=v)}r.eachRow({includeEmpty:!0},function(c,v){c.eachCell(function(W,q){W.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}})}),h.width=i<28?28:i}n.xlsx.writeBuffer().then(l=>{const i=new Blob([l],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});H.saveAs(i,"registros.xlsx")})}extractDate(e){const n=e.getDate(),r=e.getMonth()+1;let i="";return i+=n<10?`0${n}-`:`${n}-`,i+=r<10?`0${r}-`:`${r}-`,i+=`${e.getFullYear()} `,i}extractHoras(e){const n=e.getHours(),r=e.getMinutes(),l=e.getSeconds();let i="";return i+=n<10?`0${n}:`:`${n}:`,i+=r<10?`0${r}:`:`${r}:`,i+=l<10?`0${l}`:`${l}`,i}}return a.\u0275fac=function(e){return new(e||a)},a.\u0275prov=t.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a})();function V(a,o){1&a&&(t.TgZ(0,"mat-header-cell",22),t._uU(1," Fecha "),t.qZA())}function Y(a,o){if(1&a&&(t.TgZ(0,"mat-cell",23),t._uU(1),t.ALo(2,"date"),t.qZA()),2&a){const e=o.$implicit;t.xp6(1),t.hij(" ",t.xi3(2,1,e.fecha,"dd-MM-yyyy ")," ")}}function F(a,o){1&a&&(t.TgZ(0,"mat-header-cell",22),t._uU(1," Entrada "),t.qZA())}function G(a,o){if(1&a&&(t.TgZ(0,"mat-cell",23),t._uU(1),t.ALo(2,"date"),t.qZA()),2&a){const e=o.$implicit;t.xp6(1),t.hij(" ",t.xi3(2,1,e.entrada," HH:mm:ss")," ")}}function R(a,o){1&a&&(t.TgZ(0,"mat-header-cell",22),t._uU(1," Salida "),t.qZA())}function J(a,o){if(1&a&&(t.TgZ(0,"mat-cell",23),t._uU(1),t.ALo(2,"date"),t.qZA()),2&a){const e=o.$implicit;t.xp6(1),t.hij(" ",t.xi3(2,1,e.salida,"HH:mm:ss")," ")}}function B(a,o){1&a&&t._UZ(0,"mat-header-row")}function Q(a,o){if(1&a){const e=t.EpF();t.TgZ(0,"mat-row",24),t.NdJ("click",function(){const l=t.CHM(e).$implicit,i=t.oxw();return t.KtG(i.toModificar(l))}),t.qZA()}}const z=function(){return[10,15,25,100]},L=[{path:"",component:Z},{path:"ver",component:(()=>{class a{constructor(e,n,r){this._registroService=e,this._exportarMisHoraService=n,this._router=r,this.displayedColumns=["Fecha","Entrada","Salida"],this.dataSource=new d.by,this.resultsLenght=0,this.registros=[]}ngAfterViewInit(){this.dataSource.sort=this.sort,this.dataSource.paginator=this.paginator}ngOnInit(){this.getData()}getData(){this._registroService.getAll().subscribe(e=>{this.dataSource.data=e,this.resultsLenght=this.dataSource.data.length,this.registros=e},e=>{console.log(e)})}exportAExcel(){this._exportarMisHoraService.exportarExcel(this.registros)}toBack(){this._router.navigate(["entradaSalida"])}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(C),t.Y36(N),t.Y36(p.F0))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-ver"]],viewQuery:function(e,n){if(1&e&&(t.Gf(g.YE,5),t.Gf(f.NW,5)),2&e){let r;t.iGM(r=t.CRH())&&(n.sort=r.first),t.iGM(r=t.CRH())&&(n.paginator=r.first)}},decls:31,vars:5,consts:[[1,"flex","flex-col","flex-auto","min-w-0"],[1,"flex","flex-col","sm:flex-row","flex-0","sm:items-center","sm:justify-between","p-6","sm:py-8","sm:px-10","border-b","bg-card","dark:bg-transparent"],[1,"flex-1","min-w-0"],[1,"mt-2"],[1,"flex","flex-wrap","items-center","font-medium"],[1,"whitespace-nowrap","text-primary-500"],[1,"text-3xl","md:text-4xl","font-extrabold","tracking-tight","leading-7","sm:leading-10","truncate"],[1,"flex-auto","p-6","sm:p-10"],[1,"flex","items-start","justify-start"],["mat-button","","color","primary",3,"click"],["svgIcon","heroicons_outline:document-download"],[1,"table-responsive"],["matSort","",3,"dataSource"],["matColumnDef","Fecha"],["mat-sort-header","",4,"matHeaderCellDef"],["data-label","Entrada",4,"matCellDef"],["matColumnDef","Entrada"],["matColumnDef","Salida"],[4,"matHeaderRowDef"],[3,"click",4,"matRowDef","matRowDefColumns"],[3,"pageSizeOptions"],["mat-button","",3,"click"],["mat-sort-header",""],["data-label","Entrada"],[3,"click"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"a",5),t._uU(6,"Entradas"),t.qZA()(),t.TgZ(7,"h2",6),t._uU(8," Listado de entradas "),t.qZA()()()(),t.TgZ(9,"div",7)(10,"div",8)(11,"button",9),t.NdJ("click",function(){return n.exportAExcel()}),t._uU(12,"Exportar a Excel "),t._UZ(13,"mat-icon",10),t.qZA()(),t.TgZ(14,"div",11)(15,"mat-table",12),t.ynx(16,13),t.YNc(17,V,2,0,"mat-header-cell",14),t.YNc(18,Y,3,4,"mat-cell",15),t.BQk(),t.ynx(19,16),t.YNc(20,F,2,0,"mat-header-cell",14),t.YNc(21,G,3,4,"mat-cell",15),t.BQk(),t.ynx(22,17),t.YNc(23,R,2,0,"mat-header-cell",14),t.YNc(24,J,3,4,"mat-cell",15),t.BQk(),t.YNc(25,B,1,0,"mat-header-row",18),t.YNc(26,Q,1,0,"mat-row",19),t.qZA()(),t._UZ(27,"mat-paginator",20),t.TgZ(28,"div",8)(29,"button",21),t.NdJ("click",function(){return n.toBack()}),t._uU(30,"Volver"),t.qZA()()()()),2&e&&(t.xp6(15),t.Q6J("dataSource",n.dataSource),t.xp6(10),t.Q6J("matHeaderRowDef",n.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",n.displayedColumns),t.xp6(1),t.Q6J("pageSizeOptions",t.DdM(4,z)))},dependencies:[y.lW,g.YE,g.nU,d.BZ,d.fO,d.as,d.w1,d.Dz,d.nj,d.ge,d.ev,d.XQ,d.Gk,f.NW,_.Hw,x.uU],styles:[".mat-row[_ngcontent-%COMP%]:nth-child(even){background-color:#f5f5f5}.mat-row[_ngcontent-%COMP%]:nth-child(odd){background-color:#fff}.table-responsive[_ngcontent-%COMP%]{display:block;width:100%;overflow-x:auto}.table-responsive[_ngcontent-%COMP%]   .mat-table[_ngcontent-%COMP%]{width:100%;max-width:100%;margin-bottom:1rem;display:table;border-collapse:collapse;margin:0}.table-responsive[_ngcontent-%COMP%]   .mat-row[_ngcontent-%COMP%], .table-responsive[_ngcontent-%COMP%]   .mat-header-row[_ngcontent-%COMP%]{display:table-row}.table-responsive[_ngcontent-%COMP%]   .mat-cell[_ngcontent-%COMP%], .table-responsive[_ngcontent-%COMP%]   .mat-header-cell[_ngcontent-%COMP%]{word-wrap:initial;display:table-cell;padding:0 5px;line-break:unset;width:auto;white-space:nowrap;overflow:hidden;vertical-align:middle}"]}),a})()}];let I=(()=>{class a{}return a.\u0275fac=function(e){return new(e||a)},a.\u0275mod=t.oAB({type:a}),a.\u0275inj=t.cJS({imports:[x.ez,p.Bz.forChild(L),y.ot,k.QW,g.JX,d.p0,f.TU,A.t,D.m,U.c,$.o9,O.lN,_.Ps,P.$]}),a})()}}]);